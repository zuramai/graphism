var b=Object.defineProperty;var S=(t,e,o)=>e in t?b(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o;var n=(t,e,o)=>(S(t,typeof e!="symbol"?e+"":e,o),o);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const d of r.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function o(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerpolicy&&(r.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?r.credentials="include":s.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=o(s);fetch(s.href,r)}})();var w=()=>({events:{},emit(t,...e){let o=this.events[t]||[];for(let i=0,s=o.length;i<s;i++)o[i](...e)},on(t,e){var o;return(o=this.events[t])!=null&&o.push(e)||(this.events[t]=[e]),()=>{var i;this.events[t]=(i=this.events[t])==null?void 0:i.filter(s=>e!==s)}}}),y=class{constructor(){n(this,"name","line");n(this,"isHovered",!1);n(this,"isSelected",!1);n(this,"moveFrom")}},k={backgroundColor:"white",borderColor:"#ddd",borderSize:2,shape:"circle",size:50,textColor:"#222",fontSize:16,hoverBorderSize:2,fontFamily:"Lora",hoverBorderColor:"rgba(120, 118, 240, .6)",hoverBackgroundColor:"white"},x=class extends y{constructor(e,o,i){super();n(this,"id");n(this,"neighbors",[]);n(this,"nodeConfig",{});n(this,"text");n(this,"position");n(this,"movable",!1);n(this,"isHovered",!1);n(this,"isSelected",!1);n(this,"mode","normal");n(this,"gCost",0);n(this,"_borderOffset",0);n(this,"parent",null);this.id=Math.floor(Math.random()*Date.now()),this.name="node",this.text=e,this.position=o,this.nodeConfig=Object.assign(this.nodeConfig,k),this.nodeConfig=Object.assign(this.nodeConfig,i)}addNeighbor(e,o,i){this.neighbors.find(s=>s.node===e)||this.neighbors.push({node:e,distance:o,line:i})}draw(e){e.beginPath(),e.arc(this.position.x,this.position.y,this.nodeConfig.size+5,0,Math.PI*2),e.strokeStyle=this.nodeConfig.hoverBorderColor,e.fillStyle=this.nodeConfig.hoverBackgroundColor,e.lineWidth=this.nodeConfig.hoverBorderSize,e.setLineDash(this.mode==="connecting"?[50,10]:[0]),e.lineDashOffset=this._borderOffset,this.isHovered&&!this.isSelected&&e.fill(),this.isSelected&&e.stroke(),e.closePath(),e.beginPath(),e.fillStyle=this.nodeConfig.backgroundColor,e.arc(this.position.x,this.position.y,this.nodeConfig.size,0,Math.PI*2),e.strokeStyle=this.nodeConfig.borderColor,e.lineWidth=this.nodeConfig.borderSize,e.stroke(),e.fill(),e.closePath(),e.fillStyle=this.nodeConfig.textColor,e.font=`${this.nodeConfig.fontSize}px ${this.nodeConfig.fontFamily}`,e.textBaseline="middle",e.textAlign="center",e.fillText(this.text,this.position.x,this.position.y)}update(){this._borderOffset++}select(){this.isSelected=!this.isSelected,this.isSelected||(this._borderOffset=0)}move(e,o){e&&(this.position.x=e),o&&(this.position.y=o),this.neighbors.forEach(i=>{i.line.updateDistance()})}isOnCoordinate(e){return e.x>this.position.x-this.nodeConfig.size&&e.x<=this.position.x+this.nodeConfig.size&&e.y>this.position.y-this.nodeConfig.size&&e.y<=this.position.y+this.nodeConfig.size}};function f(t,e){return Math.sqrt(Math.abs(t.x-e.x)**2+Math.abs(t.y-e.y)**2)}var p={color:"#777",width:5,hoverColor:"rgba(120, 118, 240, .6)",selectedColor:"#2f5ea8",text:null,dynamicDistance:!1},L=class extends y{constructor(e,o,i,s){super();n(this,"name","line");n(this,"lineConfig",p);n(this,"from");n(this,"to");n(this,"isHovered",!1);n(this,"isSelected",!1);n(this,"distance");this.lineConfig={...p,...s},this.from=e,this.to=o,this.distance=i}draw(e){e.strokeStyle=this.lineConfig.color,this.isSelected?e.strokeStyle=this.lineConfig.selectedColor:this.isHovered&&(e.strokeStyle=this.lineConfig.hoverColor),e.lineWidth=this.lineConfig.width,e.beginPath(),e.moveTo(this.from.position.x,this.from.position.y),e.lineTo(this.to.position.x,this.to.position.y),e.stroke(),e.closePath(),this.drawText(e)}drawText(e){const o={x:(this.from.position.x+this.to.position.x)/2,y:(this.from.position.y+this.to.position.y)/2};if(e.fillStyle=this.lineConfig.selectedColor,e.font="18px Arial bold",!this.lineConfig.text){if(this.distance===0)return;e.fillText(this.distance.toString(),o.x,o.y);return}e.fillText(this.lineConfig.text,o.x,o.y)}updateDistance(){this.lineConfig.dynamicDistance&&(this.distance=Math.round(f(this.from.position,this.to.position)))}move(e,o){}isOnCoordinate(e){return Math.ceil(f(this.from.position,e))+Math.ceil(f(this.to.position,e))===Math.ceil(f(this.from.position,this.to.position))}},E=class{constructor(){n(this,"endNode");n(this,"nodes",[]);n(this,"path",[]);n(this,"startNode");n(this,"progressStack",[])}solve(t){}},B=class{constructor(){n(this,"findValue");n(this,"nodes",[]);n(this,"path",[]);n(this,"startNode");n(this,"progressStack",[])}solve(t){}},O=class{constructor(){n(this,"findValue");n(this,"nodes",[]);n(this,"path",[]);n(this,"startNode");n(this,"progressStack",[])}solve(t){}},A=class{constructor(t,e,o){n(this,"endNode");n(this,"nodes",[]);n(this,"path",[]);n(this,"startNode");n(this,"progressStack",[]);this.nodes=t,this.startNode=e,this.endNode=o}solve(t){const e=this.startNode.id,o={},i={};this.nodes.forEach(l=>{i[l.id]=!1,o[l.id]={distance:l.id===e?0:1/0,parent:null}});let s=this.startNode;for(let l=0;l<Object.keys(i).length;l++){let c=1/0,h=null;s.neighbors.forEach(a=>{!i[a.node.id]&&a.distance+o[s.id].distance<o[a.node.id].distance&&(o[a.node.id].distance=a.distance+o[s.id].distance,o[a.node.id].parent=s.id),a.distance<c&&(h=a,c=h.distance)}),i[s.id]=!0,s=h.node}const r=[this.endNode.text];let d=o[this.endNode.id].parent;for(;d;){const l=this.nodes.find(c=>c.id===d);r.push(l.text),d=o[d].parent}return r.reverse()}},M=class{constructor(){n(this,"nodes",[]);n(this,"path",[]);n(this,"startNode");n(this,"progressStack",[])}solve(t){}},F=class{constructor(){n(this,"nodes",[]);n(this,"path",[]);n(this,"startNode");n(this,"progressStack",[])}solve(t){}},_={aStar:E,bfs:B,dfs:O,dijkstra:A,prim:F,kruskal:M};function P(t,e,o,i){return new _[t](e,o,i)}var I={lineColor:"#555",nodeBackground:"white",nodeTextColor:"#555",canvasBackground:"#ccc"},z=class{constructor(t={}){n(this,"canvas");n(this,"ctx");n(this,"nodes",[]);n(this,"dragFrom");n(this,"isDirectedGraph",!1);n(this,"lines",[]);n(this,"selectedNode",[]);n(this,"holdingNode",null);n(this,"mode","normal");n(this,"_hoveredElement",null);n(this,"_emitter",w());n(this,"_runningBorderOffset",0);this.config=t,this.config=Object.assign(I,t),this.mount(t.el)}resolveSelector(t){return typeof t=="string"?document.querySelector(t):t||null}mount(t){if(this.canvas)throw new Error("[graphism] already mounted, unmount previous target first");if(this.canvas=this.resolveSelector(t),!this.canvas)throw new Error("[graphism] target element not found");this.ctx=this.canvas.getContext("2d"),this.canvas.width=this.canvas.clientWidth,this.canvas.height=this.canvas.clientHeight,this.canvas.addEventListener("mousedown",this.mouseDown.bind(this)),this.canvas.addEventListener("mousemove",this.mouseMove.bind(this)),this.canvas.addEventListener("mouseup",this.mouseUp.bind(this)),this.canvas.addEventListener("click",this.mouseClick.bind(this)),this._emitter.emit("mounted"),requestAnimationFrame(()=>this.render())}on(t,e,o=!1){const i=this._emitter.on(t,(...s)=>{o&&i(),e(...s)});return i}generateGraph(){const t=this.createNode("Jakarta",{x:130,y:274}),e=this.createNode("Bandung",{x:390,y:200});this.addNodeNeighbor(e,t,100),this.addNodeNeighbor(t,e,100);const o=[t,e];return this.nodes=o,o}draw(){this.drawBackground(),this.drawLines(),this.drawNodes()}drawLines(){for(let t=0;t<this.lines.length;t++)this.lines[t].draw(this.ctx)}drawNodes(){for(let t=0;t<this.nodes.length;t++)this.nodes[t].draw(this.ctx)}drawBackground(){typeof this.config.canvasBackground=="string"||this.config.canvasBackground instanceof CanvasPattern?(this.ctx.fillStyle=this.config.canvasBackground,this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height)):this.config.canvasBackground instanceof HTMLImageElement&&this.ctx.drawImage(this.config.canvasBackground,0,0,this.canvas.width,this.canvas.height),["creating","connecting"].includes(this.mode)&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.strokeStyle="rgb(120, 118, 240)",this.ctx.rect(0,0,this.canvas.width,this.canvas.height),this.ctx.lineWidth=10,this.ctx.setLineDash([0,25,50]),this.ctx.lineDashOffset=this._runningBorderOffset,this.ctx.stroke(),this.ctx.closePath(),this.ctx.restore())}waitingForClick(){return new Promise(t=>{this.mode="creating",this.canvas.addEventListener("click",e=>{const o=this.getCursorPosition(e);t(o)},{once:!0})})}createNode(t,e,o){const i=new x(t,e,o);return this.nodes.push(i),this._emitter.emit("node:created",i),this.setMode("normal"),this.clearSelectedNode(),i}clear(){this.lines=[],this.nodes=[],this.mode="normal"}clearSelectedNode(){for(let t=0;t<this.nodes.length;t++)this.nodes[t].isSelected=!1,this.nodes[t].mode="normal",this.nodes[t].movable=!1;this._emitter.emit("node:clearSelect"),this.selectedNode=[]}clearSelectedLine(){for(let t=0;t<this.lines.length;t++)this.lines[t].isSelected=!1;this._emitter.emit("line:clearSelect"),this.selectedNode=[]}runAlgorithm(t,e,o){const s=P(t,this.nodes,e,o).solve();console.log(s)}setMode(t){this.mode=t,this.clearSelectedNode()}addNodeNeighbor(t,e,o){let i;const s={};o==null&&(s.dynamicDistance=!0),o!=null||(o=Math.round(f(t.position,e.position)));const r=this.lines.find(d=>d.from===t&&d.to===e||d.from===e&&d.to===t);r?i=r:(i=new L(t,e,o,s),this.lines.push(i)),t.addNeighbor(e,o,i),this.isDirectedGraph||e.addNeighbor(t,o,i),this._emitter.emit("node:connect",t,e)}update(){for(let t=0;t<this.nodes.length;t++)this.nodes[t].update();["creating","connecting"].includes(this.mode)&&this._runningBorderOffset++}mouseUp(){this.holdingNode=null}mouseDown(t){const e=this.getCursorPosition(t);this.dragFrom=e;for(let o=0;o<this.nodes.length;o++){const i=this.nodes[o];if(i.isOnCoordinate(e)){this.holdingNode=i,i.moveFrom={x:i.position.x,y:i.position.y};for(let s=0;s<this.selectedNode.length;s++){const r=this.selectedNode[s];r.moveFrom={x:r.position.x,y:r.position.y}}}}}mouseMove(t){const e=this.getCursorPosition(t);let o;const i=[...this.nodes,...this.lines];if(this._hoveredElement!=null&&(this._hoveredElement.isHovered=!1,this._hoveredElement=null),this.canvas.style.cursor="grab",(o=i.find(d=>d.isOnCoordinate(e)))&&(this.canvas.style.cursor="pointer",this._emitter.emit(`${o.name}:mouseover`,o),this._hoveredElement=o,o.isHovered=!0),!this.nodes.length||!this.holdingNode)return;const s=e.x-this.dragFrom.x,r=e.y-this.dragFrom.y;if(this.selectedNode.length>1&&this.holdingNode.isSelected)for(let d=0;d<this.selectedNode.length;d++)o=this.nodes[d],o.move(o.moveFrom.x+s,o.moveFrom.y+r);else o.move(o.moveFrom.x+s,o.moveFrom.y+r)}mouseClick(t){const e=this.getCursorPosition(t);if(e.x===this.dragFrom.x&&e.y===this.dragFrom.y){this._emitter.emit("canvas:click",e);let o=!1,i=!1;for(let s=this.nodes.length-1;s>=0;s--){const r=this.nodes[s];if(r.isOnCoordinate(e)){t.ctrlKey||this.clearSelectedNode(),this.selectNode(r,this.mode),o=!0,this._emitter.emit("node:select",r);break}}for(let s=0;s<this.lines.length;s++){const r=this.lines[s];r.isOnCoordinate(e)&&(r.isSelected=!0,i=!0,this._emitter.emit("line:select",r))}i||this.clearSelectedLine(),o||this.clearSelectedNode()}}selectNode(t,e="normal"){t.select(),t.mode=t.isSelected?e:"normal",this.selectedNode.push(t)}getCursorPosition(t){const e=this.canvas.getBoundingClientRect();return{x:t.clientX-e.left,y:t.clientY-e.top}}render(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.draw(),this.update(),requestAnimationFrame(()=>this.render())}};function D(t){return new z(t)}function T(t){const e=document.createElement("a");e.setAttribute("download","graphism.png"),t.toBlob(o=>{const i=URL.createObjectURL(o);e.setAttribute("href",i),e.click()})}const N=t=>t.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`),u=(t,e)=>document.getElementById(t).addEventListener("click",e);function q(t,e,o=2e3){const i=document.createElement("div");i.classList.add("notification"),i.classList.add(`notification-${t}`),i.innerText=e;const s=document.createElement("button"),r=document.createElementNS("http://www.w3.org/2000/svg","svg"),d=document.createElementNS("http://www.w3.org/2000/svg","path");r.setAttribute("width","16"),r.setAttribute("height","16"),d.setAttribute("d","M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"),r.appendChild(d),s.appendChild(r),i.appendChild(s);const l=document.querySelector(".notifications");l.appendChild(i),setTimeout(()=>l.removeChild(i),o),s.addEventListener("click",()=>{l.removeChild(i)},{once:!0})}window.addEventListener("DOMContentLoaded",()=>{H(),$()});function H(){document.querySelectorAll(".modal").forEach(e=>{e.querySelector(".modal-close").addEventListener("click",()=>{e.classList.remove("modal-open")})})}function $(){const t=document.querySelectorAll(".sidebar-item");for(let e=0;e<t.length;e++){const o=t[e];o.querySelector(".sidebar-group-icon").addEventListener("click",()=>{t.forEach(i=>i!==o&&i.classList.remove("sidebar-item-open")),o.classList.toggle("sidebar-item-open")})}}function j(t,e){e.addEventListener("click",()=>{t.classList.toggle("modal-open")})}function W(t,e){const o=document.getElementById(t);return e.y+o.clientHeight>document.body.clientHeight&&(e.y-=o.clientHeight),e.x+o.clientWidth>document.body.clientWidth&&(e.x-=o.clientWidth),o.style.left=`${e.x}px`,o.style.top=`${e.y}px`,o.style.visibility="visible",o}const G={fontSize:22,fontFamily:"Lora",textColor:"#222",backgroundColor:"white",borderColor:"#ddd",borderSize:2,width:50,height:50,hoverBorderColor:"rgba(120, 118, 240, .6)",hoverBackgroundColor:"white"};window.onload=()=>{const t=document.querySelector("#canvas"),e=D({el:t,canvasBackground:"#efefef"}),o=Z(e,G);Q(o);const i=e.createNode("a",{x:300,y:300}),s=e.createNode("b",{x:500,y:450}),r=e.createNode("c",{x:550,y:200}),d=e.createNode("d",{x:200,y:500}),l=e.createNode("e",{x:700,y:420}),c=e.createNode("f",{x:1e3,y:420}),h=e.createNode("g",{x:500,y:620}),a=e.createNode("h",{x:800,y:300});e.addNodeNeighbor(i,s,100),e.addNodeNeighbor(i,r,150),e.addNodeNeighbor(i,d,250),e.addNodeNeighbor(s,l,50),e.addNodeNeighbor(r,l,250),e.addNodeNeighbor(c,l,250),e.addNodeNeighbor(h,d,1250),e.addNodeNeighbor(h,l,300),e.addNodeNeighbor(h,c,400),e.addNodeNeighbor(r,a,300),e.addNodeNeighbor(a,c,250),e.addNodeNeighbor(a,l,200),R(e,t)};function R(t,e){window.addEventListener("resize",Y.bind(null,e)),u("node-add",V.bind(null,t)),u("generate-graph",J.bind(null,t)),u("create-new",X),u("connectNode",K.bind(null,t)),u("saveToImage",()=>T(e)),u("clear",()=>t.clear()),j(document.querySelector(".modal-add"),document.getElementById("openAddModal")),U(t),t.on("line:select",()=>{document.getElementById("options-line").classList.remove("disabled")}),t.on("line:clearSelect",()=>{document.getElementById("options-line").classList.add("disabled")})}function U(t){u("solve-dijkstra",()=>{t.setMode("connecting"),m("Select starting node.."),t.clearSelectedNode(),t.on("node:select",e=>{m("Select ending node.."),t.on("node:select",o=>{t.runAlgorithm("dijkstra",e,o),v(),t.setMode("normal")},!0)},!0)})}function V(t){const e=document.getElementById("name");document.querySelector(".modal-add").classList.remove("modal-open"),m(`Click anywhere to create ${e.value} node`),t.setMode("creating"),t.on("canvas:click",o=>{const i=e?e.value:"";t.createNode(i,o),q("success",`Node ${i} created`),v()},!0)}function K(t){t.setMode("connecting"),m("Click any node to connect"),t.clearSelectedNode(),t.on("node:select",e=>{t.on("node:select",o=>{const i=W("poppover-distance",{x:o.position.x,y:o.position.y});i.querySelector("form").addEventListener("submit",r=>{r.preventDefault();const d=document.getElementById("distance-value").value;t.addNodeNeighbor(e,o,d===""?null:~~d),t.clearSelectedNode(),t.mode="normal",i.style.visibility="hidden"},{once:!0})},!0)},!0),t.on("node:connect",()=>{v()},!0)}function J(t){const e=t.generateGraph();t.nodes=e,C()}function X(){C()}function C(){document.querySelector(".page-title").classList.toggle("show")}const g=document.getElementById("helper-text");function m(t,e=!0){e&&g.classList.add("blinking"),g.innerText=t,g.classList.add("show")}function v(){g.classList.remove("blinking"),g.classList.remove("show")}function Y(t){t.width=window.innerWidth,t.height=window.innerHeight,t.setAttribute("width",t.width.toString()),t.setAttribute("height",t.height.toString())}function Z(t,e){return new Proxy(e,{set(o,i,s){o[i]=s;const r=document.getElementById(`custom-${N(i)}`);return r.value=s,t.selectedNode[0].nodeConfig[i]=s,!0}})}function Q(t){Object.keys(t).forEach(e=>{let o=document.getElementById(`custom-${N(e)}`);o||(o=document.querySelector(e)),o.addEventListener("input",()=>t[e]=o.value)})}
