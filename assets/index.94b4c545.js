var p=Object.defineProperty;var C=(e,t,i)=>t in e?p(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var r=(e,t,i)=>(C(e,typeof t!="symbol"?t+"":t,i),i);const y=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const d of n.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&s(d)}).observe(document,{childList:!0,subtree:!0});function i(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerpolicy&&(n.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?n.credentials="include":o.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(o){if(o.ep)return;o.ep=!0;const n=i(o);fetch(o.href,n)}};y();var w={backgroundColor:"white",borderColor:"#ddd",borderSize:2,shape:"circle",size:50,textColor:"#222",fontSize:16,hoverBorderSize:2,fontFamily:"Lora",hoverBorderColor:"rgba(120, 118, 240, .6)",hoverBackgroundColor:"white"},b=class{constructor(e,t,i){r(this,"name","node");r(this,"neighbors",[]);r(this,"nodeConfig",{});r(this,"text");r(this,"position");r(this,"movable",!1);r(this,"moveFrom");r(this,"isHovered",!1);r(this,"isSelected",!1);r(this,"mode","normal");r(this,"_borderOffset",0);r(this,"gCost",0);r(this,"parent",null);this.text=e,this.position=t,this.nodeConfig=Object.assign(this.nodeConfig,w),this.nodeConfig=Object.assign(this.nodeConfig,i)}addNeighbor(e,t,i){this.neighbors.find(s=>s.node==e)||this.neighbors.push({node:e,distance:t,line:i})}draw(e){e.beginPath(),e.arc(this.position.x,this.position.y,this.nodeConfig.size+5,0,Math.PI*2),e.strokeStyle=this.nodeConfig.hoverBorderColor,e.fillStyle=this.nodeConfig.hoverBackgroundColor,e.lineWidth=this.nodeConfig.hoverBorderSize,e.setLineDash(this.mode=="connecting"?[50,10]:[0]),e.lineDashOffset=this._borderOffset,this.isHovered&&!this.isSelected&&e.fill(),this.isSelected&&e.stroke(),e.closePath(),e.beginPath(),e.fillStyle=this.nodeConfig.backgroundColor,e.arc(this.position.x,this.position.y,this.nodeConfig.size,0,Math.PI*2),e.strokeStyle=this.nodeConfig.borderColor,e.lineWidth=this.nodeConfig.borderSize,e.stroke(),e.fill(),e.closePath(),e.fillStyle=this.nodeConfig.textColor,e.font=`${this.nodeConfig.fontSize}px ${this.nodeConfig.fontFamily}`,e.textBaseline="middle",e.textAlign="center",e.fillText(this.text,this.position.x,this.position.y)}update(){this._borderOffset++}select(){this.isSelected=!this.isSelected,this.isSelected||(this._borderOffset=0)}move(e,t){e&&(this.position.x=e),t&&(this.position.y=t)}isOnCoordinate(e){return e.x>this.position.x-this.nodeConfig.size&&e.x<=this.position.x+this.nodeConfig.size&&e.y>this.position.y-this.nodeConfig.size&&e.y<=this.position.y+this.nodeConfig.size}},S=()=>({events:{},emit(e,...t){(this.events[e]||[]).forEach(i=>i(...t))},on(e,t){return(this.events[e]=this.events[e]||[]).push(t),()=>this.events[e]=(this.events[e]||[]).filter(i=>i!==t)}});function h(e,t){return Math.sqrt(Math.abs(e.x-t.x)**2+Math.abs(e.y-t.y)**2)}var g={color:"#777",width:5,hoverColor:"rgba(120, 118, 240, .6)",selectedColor:"#2f5ea8",text:""},N=class{constructor(e,t,i){r(this,"name","line");r(this,"moveFrom");r(this,"lineConfig",g);r(this,"from");r(this,"to");r(this,"isHovered",!1);r(this,"isSelected",!1);this.lineConfig=Object.assign(g,i),this.from=e,this.to=t}draw(e){e.strokeStyle=this.lineConfig.color,this.isSelected?e.strokeStyle=this.lineConfig.selectedColor:this.isHovered&&(e.strokeStyle=this.lineConfig.hoverColor),e.lineWidth=this.lineConfig.width,e.beginPath(),e.moveTo(this.from.position.x,this.from.position.y),e.lineTo(this.to.position.x,this.to.position.y),e.stroke(),e.closePath()}isOnCoordinate(e){return Math.ceil(h(this.from.position,e))+Math.ceil(h(this.to.position,e))==Math.ceil(h(this.from.position,this.to.position))}move(){}},k={lineColor:"#555",nodeBackground:"white",nodeTextColor:"#555",canvasBackground:"#ccc"},L=class{constructor(e={}){r(this,"canvas");r(this,"ctx");r(this,"nodes",[]);r(this,"dragFrom");r(this,"isDirectedGraph",!1);r(this,"lines",[]);r(this,"selectedNode",[]);r(this,"holdingNode",null);r(this,"mode","normal");r(this,"_hoveredElement",null);r(this,"_emitter",S());r(this,"_runningBorderOffset",0);this.config=e,this.config=Object.assign(k,e),this.mount(e.el)}resolveSelector(e){return typeof e=="string"?document.querySelector(e):e||null}mount(e){if(this.canvas)throw new Error("[graphism] already mounted, unmount previous target first");if(this.canvas=this.resolveSelector(e),!this.canvas)throw new Error("[graphism] target element not found");this.ctx=this.canvas.getContext("2d"),this.canvas.width=this.canvas.clientWidth,this.canvas.height=this.canvas.clientHeight,this.canvas.addEventListener("mousedown",this.mouseDown.bind(this)),this.canvas.addEventListener("mousemove",this.mouseMove.bind(this)),this.canvas.addEventListener("mouseup",this.mouseUp.bind(this)),this.canvas.addEventListener("click",this.mouseClick.bind(this)),this._emitter.emit("mounted"),requestAnimationFrame(()=>this.render())}on(e,t,i=!1){const s=this._emitter.on(e,(...o)=>{i&&s(),t(...o)});return s}generateGraph(){const e=this.createNode("Jakarta",{x:130,y:274}),t=this.createNode("Bandung",{x:390,y:200});this.addNodeNeighbor(t,e,100),this.addNodeNeighbor(e,t,100);const i=[e,t];return this.nodes=i,i}draw(){this.drawBackground(),this.drawLines(),this.drawNodes()}drawLines(){for(let e=0;e<this.lines.length;e++)this.lines[e].draw(this.ctx)}drawNodes(){for(let e=0;e<this.nodes.length;e++)this.nodes[e].draw(this.ctx)}drawBackground(){typeof this.config.canvasBackground=="string"||this.config.canvasBackground instanceof CanvasPattern?(this.ctx.fillStyle=this.config.canvasBackground,this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height)):this.config.canvasBackground instanceof HTMLImageElement&&this.ctx.drawImage(this.config.canvasBackground,0,0,this.canvas.width,this.canvas.height),["creating","connecting"].includes(this.mode)&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.strokeStyle="rgb(120, 118, 240)",this.ctx.rect(0,0,this.canvas.width,this.canvas.height),this.ctx.lineWidth=10,this.ctx.setLineDash([0,25,50]),this.ctx.lineDashOffset=this._runningBorderOffset,this.ctx.stroke(),this.ctx.closePath(),this.ctx.restore())}waitingForClick(){return new Promise(e=>{this.mode="creating",this.canvas.addEventListener("click",t=>{let i=this.getCursorPosition(t);e(i)},{once:!0})})}createNode(e,t,i){let s=new b(e,t,i);return this.nodes.push(s),this._emitter.emit("node:created",s),this.setMode("normal"),this.clearSelectedNode(),console.log("creating new node ",e," at ",t),s}clearSelectedNode(){for(let e=0;e<this.nodes.length;e++)this.nodes[e].isSelected=!1,this.nodes[e].mode="normal",this.nodes[e].movable=!1;this.selectedNode=[],console.log("clearing selected node")}clearSelectedLine(){for(let e=0;e<this.lines.length;e++)this.lines[e].isSelected=!1;this.selectedNode=[],console.log("clearing selected node")}setMode(e){switch(this.mode=e,e){case"connecting":this.clearSelectedNode(),this.on("node:click",t=>{this.on("node:click",i=>{this.addNodeNeighbor(t,i,0),this.clearSelectedNode(),this.mode="normal"},!0)},!0);break}}addNodeNeighbor(e,t,i){let s,o=this.lines.find(n=>n.from==e&&n.to==t||n.from==t&&n.to==e);o?s=o:(s=new N(e,t,{}),this.lines.push(s)),e.addNeighbor(t,i,s),this.isDirectedGraph||t.addNeighbor(e,i,s),this._emitter.emit("node:connect",e,t)}update(){for(let e=0;e<this.nodes.length;e++)this.nodes[e].update();["creating","connecting"].includes(this.mode)&&this._runningBorderOffset++}mouseUp(){this.holdingNode=null,console.log("Mouseup ",this.selectedNode)}mouseDown(e){let t=this.getCursorPosition(e);console.log("mousedown"),this.dragFrom=t;for(let i=0;i<this.nodes.length;i++){let s=this.nodes[i];if(s.isOnCoordinate(t)){this.holdingNode=s,s.moveFrom={x:s.position.x,y:s.position.y};for(let o=0;o<this.selectedNode.length;o++){let n=this.selectedNode[o];n.moveFrom={x:n.position.x,y:n.position.y}}}}}mouseMove(e){let t=this.getCursorPosition(e),i,s=[...this.nodes,...this.lines];if(this._hoveredElement!=null&&(this._hoveredElement.isHovered=!1,this._hoveredElement=null),this.canvas.style.cursor="grab",(i=s.find(d=>d.isOnCoordinate(t)))&&(this.canvas.style.cursor="pointer",this._emitter.emit(`${i.name}:mouseover`,i),this._hoveredElement=i,i.isHovered=!0),!this.nodes.length||!this.holdingNode)return;let o=t.x-this.dragFrom.x,n=t.y-this.dragFrom.y;if(console.log("Move dx = ",o," dy",n),this.selectedNode.length>1&&this.holdingNode.isSelected)for(let d=0;d<this.selectedNode.length;d++)i=this.nodes[d],i.move(i.moveFrom.x+o,i.moveFrom.y+n);else i.move(i.moveFrom.x+o,i.moveFrom.y+n)}mouseClick(e){let t=this.getCursorPosition(e);if(t.x==this.dragFrom.x&&t.y==this.dragFrom.y){this._emitter.emit("canvas:click",t);let i=!1,s=!1;for(let o=this.nodes.length-1;o>=0;o--){let n=this.nodes[o];if(n.isOnCoordinate(t)){e.ctrlKey||this.clearSelectedNode(),this.selectNode(n,this.mode),i=!0,this._emitter.emit("node:click",n);break}}for(let o=0;o<this.lines.length;o++){let n=this.lines[o];n.isOnCoordinate(t)&&(n.isSelected=!0,s=!0,console.log("line cliekd"))}s||this.clearSelectedLine(),i||this.clearSelectedNode()}}selectNode(e,t="normal"){e.select(),e.mode=e.isSelected?t:"normal",this.selectedNode.push(e)}getCursorPosition(e){let t=this.canvas.getBoundingClientRect();return{x:e.clientX-t.left,y:e.clientY-t.top}}render(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.draw(),this.update(),requestAnimationFrame(()=>this.render())}};function E(e){return new L(e)}const u=e=>e.replace(/[A-Z]/g,t=>`-${t.toLowerCase()}`);window.onload=()=>{const e=document.querySelector("#canvas"),t=E({el:e,canvasBackground:"#efefef"});window.addEventListener("resize",z.bind(null,e)),document.getElementById("node-add").addEventListener("click",B.bind(null,t)),document.getElementById("generate-graph").addEventListener("click",M.bind(null,t)),document.getElementById("create-new").addEventListener("click",F),document.getElementById("connectNode").addEventListener("click",O.bind(null,t));let i=_(t,x);q(i);let s=t.createNode("ASC",{x:300,y:300}),o=t.createNode("WSC",{x:700,y:400});t.addNodeNeighbor(s,o,100)};let x={fontSize:22,fontFamily:"Lora",textColor:"#222",backgroundColor:"white",borderColor:"#ddd",borderSize:2,width:50,height:50,hoverBorderColor:"rgba(120, 118, 240, .6)",hoverBackgroundColor:"white"};function B(e){let t=document.getElementById("name");document.querySelector(".modal-add").classList.remove("modal-open"),m(`Click anywhere to create ${t.value} node`),e.setMode("creating"),e.on("canvas:click",i=>{let s=t?t.value:"";e.createNode(s,i),P("success",`Node ${s} created`),v()},!0)}function O(e){e.setMode("connecting"),m("Click any node to connect"),e.on("node:connect",()=>{v()})}function M(e){const t=e.generateGraph();e.nodes=t,f()}function F(){f()}function f(){document.querySelector(".page-title").classList.toggle("show")}const l=document.getElementById("helper-text");function m(e,t=!0){t&&l.classList.add("blinking"),l.innerText=e,l.classList.add("show")}function v(){l.classList.remove("blinking"),l.classList.remove("show")}function P(e,t,i=2e3){let s=document.createElement("div");s.classList.add("notification"),s.classList.add(`notification-${e}`),s.innerText=t;let o=document.createElement("button"),n=document.createElementNS("http://www.w3.org/2000/svg","svg"),d=document.createElementNS("http://www.w3.org/2000/svg","path");n.setAttribute("width","16"),n.setAttribute("height","16"),d.setAttribute("d","M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"),n.appendChild(d),o.appendChild(n),s.appendChild(o);let a=document.querySelector(".notifications");a.appendChild(s),setTimeout(()=>a.removeChild(s),i),o.addEventListener("click",()=>{a.removeChild(s)},{once:!0})}function z(e){e.width=window.innerWidth,e.height=window.innerHeight,e.setAttribute("width",e.width.toString()),e.setAttribute("height",e.height.toString())}function _(e,t){return new Proxy(t,{set(i,s,o){i[s]=o;let n=document.getElementById(`custom-${u(s)}`);return n.value=o,console.log("Changing: ",e.selectedNode[0]),e.selectedNode[0].nodeConfig[s]=o,!0}})}function q(e){Object.keys(e).forEach(t=>{console.log(`querying: custom-${u(t)}`);let i=document.getElementById(`custom-${u(t)}`);i||(i=document.querySelector(t)),i.addEventListener("input",()=>e[t]=i.value)})}let A=document.querySelectorAll(".modal");A.forEach(e=>{e.querySelector(".modal-close").addEventListener("click",i=>{e.classList.remove("modal-open")})});const I=document.querySelector(".modal-add"),T=document.getElementById("openAddModal");T.addEventListener("click",e=>{I.classList.toggle("modal-open"),console.log("open")});let c=document.querySelectorAll(".sidebar-item");for(let e=0;e<c.length;e++){let t=c[e];t.querySelector(".sidebar-group-icon").addEventListener("click",()=>{c.forEach(i=>i!==t&&i.classList.remove("sidebar-item-open")),t.classList.toggle("sidebar-item-open")})}
